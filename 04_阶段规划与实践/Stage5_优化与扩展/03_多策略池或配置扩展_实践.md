# Phase3 · 03 · 多策略池或配置扩展（可选）

> [!NOTE] **[TRACEBACK] 战略追溯锚点**
> - **顶层概念**: [一句话定义与核心价值](../../01_顶层概念/01_一句话定义与核心价值.md)
> - **战略维度**: [01_产品设计维度](../../02_战略维度/产品设计/01_产品设计维度.md)
> - **原子能力**: [09_核心模块架构规约](../../03_原子目标与规约/_共享规约/09_核心模块架构规约.md)（Module B 策略池）、[01_需求与产品范围](../../03_原子目标与规约/产品设计/01_需求与产品范围.md)
> - **阶段**: [Phase3_优化与扩展](README.md)
> - **本步骤**: 多策略池或配置扩展，按 09 与 L1 查漏补缺

**本步设计文档**：[03_多策略池或配置扩展设计](../../03_原子目标与规约/Stage5_优化与扩展/03_多策略池或配置扩展设计.md#design-stage5-03-exit)  
**本步 DNA 文件**：[03_原子目标与规约/_System_DNA/Stage5_优化与扩展/dna_stage5_03.yaml](../../03_原子目标与规约/_System_DNA/Stage5_优化与扩展/dna_stage5_03.yaml)

<a id="l4-step-nav"></a>
## 步骤导航
- **上一步**：[02_成本治理与Token熔断_实践](02_成本治理与Token熔断_实践.md#l4-stage5-02-goal)
- **下一步**：[04_Level1与L5验收对齐_实践](04_Level1与L5验收对齐_实践.md#l4-stage5-04-goal)

> [!IMPORTANT] **实践测试方式约定**
> 本步以**本地 Docker Compose**（或等价本地环境）为**主要（默认）**实践测试方式，可选 K3s/实盘；无云凭证或无需真实集群时**优先**使用本地 Compose 完成验收。见 [00_系统规则_通用项目协议](../../00_系统规则_通用项目协议.md)、[02_三位一体仓库规约](../../03_原子目标与规约/_共享规约/02_三位一体仓库规约.md)#本地开发与部署文件。

<a id="l4-stage5-03-goal"></a>
## 步骤目标

- **L3 阶段目标**：Phase3 按 09 规约与 L1 价值查漏补缺；多策略池（Trend/Reversion/Breakout）或配置扩展，满足产品范围与不可能三角的扩展需求。
- **本步目标**：在 09_ Module B 已有策略池基础上，扩展多策略池配置或新增策略类型；或对全局配置（如阈值、开关）做可配置化扩展，便于后续迭代。

## 关键产出物

1. 多策略池或配置扩展已落地；新增/变更项可追溯至 09_ 或 L1
2. 配置来源明确（DNA 或配置文件）；变更影响可复核
3. L5 对应行已更新（若适用）

## 本步骤可开始条件（Definition of Ready）

1. Phase1、Phase2 已完成；Module B 策略池与 D 判官已就绪。
2. 工作目录 **diting-core** 可编辑。
3. [09_](../../03_原子目标与规约/_共享规约/09_核心模块架构规约.md) Module B、[01_需求与产品范围](../../03_原子目标与规约/产品设计/01_需求与产品范围.md) 可引用。

## 推荐模型（可选）

由执行方自选；可引用 [Phase3 README](README.md)。

## 核心指令（The Prompt）

请先阅读 03_原子目标与规约/_共享规约/09_核心模块架构规约.md（Module B）、本步骤「实施内容」。任务：1. 扩展多策略池配置或新增策略类型（与 03_原子目标与规约/产品设计/01_需求与产品范围.md、03_原子目标与规约/_共享规约/09_核心模块架构规约.md 兼容）；2. 将硬编码阈值/开关收敛到配置或 DNA 引用；3. 对照 L1 价值与 03_原子目标与规约/_共享规约/09_核心模块架构规约.md 能力查漏补缺。工作目录 diting-core。请输出：变更列表、配置键说明、验证摘要。

## Prompt 使用说明

将核心指令与 09_ Module B 一起喂给 AI；执行后用「验收与测试」自检。

## 技术约束（DO / DON'T / 边界）

| 类型 | 内容 |
|------|------|
| **DO** | 与 09_、01_ 兼容；配置来自 DNA 或配置文件；工作目录 diting-core |
| **DON'T** | 不要破坏既有策略池契约 |
| **边界** | 本步为可选扩展；按需 5D |

## 必读顺序

1. [09_](../../03_原子目标与规约/_共享规约/09_核心模块架构规约.md) Module B；[01_需求与产品范围](../../03_原子目标与规约/产品设计/01_需求与产品范围.md) 第四节
2. 本步骤「实施内容」「验收与测试」

## 依赖的 Stage

- 依赖 [Stage3_模块实践](../Stage3_模块实践/README.md)、[Stage4_MoE与执行网关](../Stage4_MoE与执行网关/README.md) 或 Stage5 前两步完成。
- **前置 Phase**：Phase1、Phase2 已完成。

## 前置条件

- Module B 策略池与 D 判官已就绪；需扩展策略或配置时再执行本步。
- 工作目录 **diting-core**。

## 实施内容

**工作目录**：`diting-core`

1. **多策略池扩展**
   - 按 09_ Module B 的 Pool 1/2/3 或 DNA 中策略池配置，增加可配置开关或权重；或新增策略类型（与 01_核心公式、09_ 兼容）。

2. **配置扩展**
   - 将硬编码阈值、开关收敛到配置或 DNA 引用（如 core_modules、product_scope）；便于 L3/DNA 变更时按 [01_L3_DNA_变更对L4影响表](../../06_追溯与审计/01_L3_DNA_变更对L4影响表.md) 复核。

3. **查漏补缺**
   - 对照 [01_需求与产品范围 第四节](../../03_原子目标与规约/产品设计/01_需求与产品范围.md) L1 价值映射与 09_ 能力清单，补齐本 Phase 内尚未覆盖的配置项或策略扩展。

## 验收与测试

本节即本步骤验收标准。

**验收检查项**

- [ ] 多策略池或配置扩展已落地；新增/变更项可追溯至 09_ 或 L1。
- [ ] 配置来源明确（DNA 或配置文件）；变更影响可复核。

**可复制测试命令**（工作目录：`diting-core`）

```bash
cd diting-core
make test
```

**成功标准**：扩展可生效、可追溯。**与 DoD 分工**：上列为功能/产物验收；DoD 负责提交、Review、L5 更新（若适用）。

<a id="l4-stage5-03-exit"></a>
## 本步骤准出（DoD）

- [ ] 代码/配置已提交（工作目录 diting-core）
- [ ] 扩展可验证；Code Review 通过（或标注豁免）
- [ ] 已更新 L5 对应行（若 DoD 要求）：[l5-stage-stage5_03](../../05_成功标识与验证/02_验收标准.md#l5-stage-stage5_03)

## 输出格式 / 期望交付形态

1. 变更/配置列表；2. 配置键与 09_/L1 追溯说明；3. 验证摘要

## 下一步

完成本步且通过验收后，可进入 [04_Level1与L5验收对齐](04_Level1与L5验收对齐.md)。本步为可选，可按需执行。

## 本步骤涉及的 DNA 键

| DNA 键 | 用途 |
|--------|------|
| `product_scope.phases` Phase3-xxx | 本 Phase 范围 |
| `core_modules.module_b`（若存在） | 策略池与阈值配置 |

## 逻辑密集说明

本步骤为可选扩展，**按需 5D**；配置化为主可简化。
