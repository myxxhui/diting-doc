# L3 · 需求与产品范围规约

> [!NOTE] **[TRACEBACK] 原子规约锚点**
> - **顶层概念**: [一句话定义与核心价值](../../01_顶层概念/01_一句话定义与核心价值.md)
> - **战略维度**: [01_产品设计维度](../../02_战略维度/产品设计/01_产品设计维度.md)
> - **对应 DNA**: `_System_DNA/global_const.yaml` 下 `product_scope`
> - **本文档**: L3 层级，定义需求与产品范围、Phase 目标与验收价值

## 一、与开发生命周期规约的边界

- **本规约**定义 **产品范围与阶段目标**：各 Phase 交付哪些能力、验收什么价值、与 L1 的映射；不定义环境阶段或流水线顺序。
- **[01_开发生命周期与实践流程规约](../开发与交付/01_开发生命周期与实践流程规约.md)** 定义 **环境阶段与流程**（骨架期 → 逻辑填充期 → Docker → K3s → 流水线衔接）。
- **配合方式**：产品定范围与节奏，交付定流程与环境；L4 Phase 步骤须同时引用本规约（阶段目标、价值验收）与 01 规约（环境阶段、依赖的交付步骤）。

---

## 二、Phase 划分与阶段目标

以下与 L3 [09_核心模块架构规约](../_共享规约/09_核心模块架构规约.md) 的 Module A–F 对应；具体范围可根据项目实际在 L4 或 ADR 中细化。

| Phase（L4） | 阶段目标（产品维度） | 对应开发生命周期阶段 | 本 Phase 主要功能模块 | 验收时部署形态 | 说明 |
|-------------|----------------------|------------------------|------------------------|-----------------|------|
| **Phase0-Infra** | 仓库骨架、基础设施与 IaC 准备 | 阶段 0（骨架）+ 部分阶段 2 | 三位一体仓库结构、可选 Docker/IaC 骨架 | 仅本地 | 与 [01_开发生命周期](../开发与交付/01_开发生命周期与实践流程规约.md) 阶段 0、部分阶段 2 对应 |
| **Phase1-xxx** | 核心链路最小可跑通：量化信号 → 判官 → 风控占位 | 阶段 1 + 可选 1b（Mock）+ 阶段 2 | Module A/B 骨架 + Module D 判官最小闭环 + Module E 占位 | 本地 → Docker | 逻辑填充 + Mock 验证 + Docker 内测试 |
| **Phase2-xxx** | MoE 议会与执行网关接入，回测/仿真可验证 | 阶段 3 + 阶段 4 | Module C 议会、Module F 执行网关；回测与实盘一致验证 | K3s dev | 与 01 规约阶段 2、3 对应 |
| **Phase3-xxx** | 优化与扩展（多策略池、可观测性、成本治理等） | 阶段 3、4 | 按 09 规约与 L1 价值查漏补缺 | K3s dev / 流水线入口 | 与 01 规约阶段 3、4 对应 |

新建或拆分 Phase 时，须在本规约或 L4 Phase README 中标明上述对应关系，并引用 01 规约的环境阶段。

### B 轨 Phase 与验收

B 轨（长期捕手轨）的阶段目标与验收**分轨统计**，不与 A 轨不可能三角 KPI 混用；具体数值与用例以 L5 验收文档与 L4 步骤为准。

| Phase（L4） | B 轨相关阶段目标（战略级） | B 轨验收方向（示例） |
|-------------|----------------------------|----------------------|
| **Phase0-Infra** | — | 无 B 轨专项 |
| **Phase1-xxx** | 判官（Module D）占位或最小闭环，支持 `TimeHorizon` 分支 | 协议可区分 SHORT_TERM / LONG_TERM |
| **Phase2-xxx** | VC-Agent 接入、B 轨分账与仓位标识、逻辑证伪/大周期反转可追溯 | VC-Agent 信号与执行率可测；分轨报表可产出 |
| **Phase3-xxx** | B 轨复盘指标、分轨报表与归因 | B 轨 MaxDD、持仓周期、逻辑证伪/反转触发记录可查；不与 A 轨标准混评 |

B 轨验收指标定义与 L1/L2 一致，见 [02_战略目标与ROI](../../01_顶层概念/02_战略目标与ROI.md)#b-轨关键指标、[03_双轨制与VC-Agent](../../01_顶层概念/03_双轨制与VC-Agent.md)#ab轨规范边界。

**L3 实践要求**：L4 Phase 准出时须按上表核对 B 轨相关阶段目标是否达成；若 L5 已建立 B 轨专项验收条目（如 VC-Agent 信号与执行率、分轨报表可产出），验收时须一并满足，不得用 A 轨不可能三角 KPI 替代 B 轨验收。

---

## 三、功能范围与优先级

### 与 09 核心模块的对应关系

- 功能范围以 [09_核心模块架构规约](../_共享规约/09_核心模块架构规约.md) 中的 Module A–F 及输入/输出/规则为能力清单；本规约只约定「各 Phase 覆盖哪些模块或子集」，不重复定义接口或实现。
- 各 Phase 的详细功能清单可在 L4 Phase README 或步骤文档中展开，并引用 09 的对应章节。

### 优先级规则（战略级）

- **P0（生存底线相关）**：风控盾（Module E）、密钥与合规、回撤与止损相关能力优先落地，与 L1「生存底线」对应。
- **P1（认知边界与复利）**：量化信号与判官闭环（A/B/D）、MoE 议会（C）、回测与实盘一致（研产同构），与 L1「认知边界」「复利增长」对应。
- 具体排期与迭代顺序由 L4 或项目计划定，本规约只定原则。

---

## 四、与 L1 的映射

| L1 价值点 | 本规约中的体现 | Phase 验收方向（示例） |
|-----------|----------------|------------------------|
| **不可能三角：认知边界 (Certainty)** | Phase 目标可包含「可解释性、胜率验证」 | 推理可追溯、Table-Driven Tests 覆盖边界 |
| **不可能三角：复利增长 (Growth)** | Phase 目标可包含「回测/实盘一致、复利指标可测」 | 研产同构验证、CAGR 可算 |
| **不可能三角：生存底线 (Survival)** | P0 优先风控与合规能力 | Module E 拦截率、密钥零泄露验收 |
| **核心公式** | 各 Phase 交付物须支撑 Alpha = (Quant ∩ Router) × Kelly 链路 | 各 Phase 准出时对应链路节点可运行或可测 |

L4 Phase 的验收标准须可溯源到上表及 L1 文档。

---

## 五、各 Phase 的验收价值标准

以下为可量化或可判定的验收方向；具体数值与用例以 L5 验收文档与 L4 步骤为准。

- **Phase0-Infra**：仓库结构符合 02_三位一体仓库规约；可选 Docker/ IaC 骨架就绪；可被后续 Phase 引用为前置条件。
- **Phase1-xxx**：回测或单链路可跑通 A→B→D 最小路径（或项目约定的最小闭环）；本地单测与必要集成测试通过；满足 01 规约阶段 1 准出条件。
- **Phase2-xxx**：MoE 议会与执行网关接入；回测与仿真环境行为与 01 规约阶段 2/3 一致；满足「研产同构」可验证。
- **Phase3-xxx**：按 L1 与战略维度查漏补缺；满足三级流水线入口要求（见 03_架构设计共识）；价值验收与 L5 对齐。

---

## 六、引用与合规

- **引用**：[09_核心模块架构规约](../_共享规约/09_核心模块架构规约.md)（能力清单）、[01_开发生命周期与实践流程规约](../开发与交付/01_开发生命周期与实践流程规约.md)（环境阶段与流程）。
- **合规**：本规约只定义产品范围与阶段目标、验收价值；环境阶段、准入准出、测试类型以 01 规约与 03_架构设计共识 为准。L4 实施步骤须同时符合本规约与 01 规约。

---

## 下一步

→ 参见 [04_阶段规划与实践/](../../04_阶段规划与实践/) 下的 Phase 目录与 [Stage1～Stage5](../../04_阶段规划与实践/Stage1～Stage5/)；Phase 步骤须标明对应本规约的阶段目标与 01 规约的环境阶段。
